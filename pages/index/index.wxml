<!-- index.wxml -->

<view class="container">
  <!-- 心情日记 -->
  <view class="mood-card">
    <view class="date">{{todayDate}}</view>
    <image class="detail-btn" src="cloud://emotion-7gazfr5v6f07338a.656d-emotion-7gazfr5v6f07338a-1324897039/pics/right.svg" bindtap="goToDiary" />
    <view class="mood-write" bindtap="openFloatWindow" wx:if="{{!isDiaryExist}}">
      <view class="mood-content">
        <view class="mood-text">你今天心情如何？</view>
      </view>
    </view>
    <view class="mood-display" bindtap="goToDiary" wx:else>
      <view class="mood-content">
        <view class="mood-text" hidden="{{latestDiary.idea === ''}}">“{{latestDiary.idea}}</view><view class="mood-text" hidden="{{latestDiary.idea === ''}}">”</view>
        <view class="mood-emoWord">{{latestDiary.emoWords.length > 2 ? latestDiary.emoWords[0] + "," + latestDiary.emoWords[1] + "..." : latestDiary.emoWords}}</view>
      </view>
    </view>
  </view>

  <!-- 功能卡片 -->
  <view class="function-card">
    <!-- 心理测评 -->
    <navigator class="sub-card" url="/pages/evaluation/evaluation">
      <image class="sub-image" src="cloud://emotion-7gazfr5v6f07338a.656d-emotion-7gazfr5v6f07338a-1324897039/pics/scale.png">
        <view class="name">心理测评</view>
      </image>
    </navigator>


    <!-- 情绪调适 -->
    <navigator class="sub-card" url="/pages/adjust/adjust">
      <image class="sub-image" src="cloud://emotion-7gazfr5v6f07338a.656d-emotion-7gazfr5v6f07338a-1324897039/pics/heart.png">
        <view class="name">情绪调适</view>
      </image>
    </navigator>
  </view>

  <!--心理格言-->
  <view class="quote-card">
    <view class="quote">{{quoteRecord.content}}</view>
    <view class="quote-author">{{quoteRecord.author}}</view>
  </view>

  <!--科普文章-->
  <view class="article-card" wx:for="{{contentList}}" wx:key="_id" bindtap="openWindow">
    <image class="article-image" src="{{item.cover}}"></image>
    <view class="article-info">
      <view class="article-name">{{item.title}}</view>
      <view class="article-detail">{{item.detail}}</view>
    </view>
  </view>
  <cover-view class="overlay" wx:if="{{ showWindow }}" bindtap="closeWindow"> </cover-view>
  <cover-view class="window-content" wx:if="{{showWindow}}" wx:for="{{contentList}}" wx:key="_id">
    <cover-image class="article-head-image" src="{{item.headImage}}"></cover-image>
    <cover-view class="article-title">{{item.title}}</cover-view>
    <cover-view class="article-content" wx:for="{{item.content}}" wx:key="index">{{item}}

    </cover-view>
  </cover-view>

  <view class="line"></view>

  <!--底部信息-->
  <view class="end">由 “与情绪共舞”项目组 开发</view>
  <image class="logo" src="cloud://emotion-7gazfr5v6f07338a.656d-emotion-7gazfr5v6f07338a-1324897039/pics/logo.png"></image>

  <!--心情日记悬浮按钮-->
  <view class="float-button" bindtap="openFloatWindow">
    <image class="float-button-icon" src="cloud://emotion-7gazfr5v6f07338a.656d-emotion-7gazfr5v6f07338a-1324897039/pics/edit.png" />
  </view>

  <!-- 心情日记悬浮窗 -->
  <view wx:if="{{showFloatWindow}}" class="float-mask" bindtap="closeFloatWindow"></view>
  <view class="float-window" wx:if="{{ showFloatWindow }}">
    <view class="float-window-content">你现在…</view>
    <view class="slider-container">
      <view class="slider-guide">感到愉悦的程度：</view>
      <slider class="custom-slider" min="-4" max="4" value="{{selectedValue1}}" block-size="20" activeColor=" #6EC6FF" bindchange="handleSliderChange1" bindchanging="hdSldChanging1"></slider>
      <view class="slider-value-box">
        <view class="slider-value">{{selectedWord1}}</view>
      </view>
    </view>
    <view class="slider-container">
      <view class="slider-guide">唤醒水平：</view>
      <slider class="custom-slider" min="-4" max="4" value="{{selectedValue2}}" block-size="20" activeColor=" #6EC6FF" bindchange="handleSliderChange2" bindchanging="hdSldChanging2"></slider>
      <view class="slider-value-box">
        <view class="slider-value">{{selectedWord2}}</view>
      </view>
    </view>
    <view class="meaning-container">
      <block wx:for="{{selectedMeaning}}" wx:key="index">
        <text class="selected-meaning-{{selectedItems[index] ? 'active' : 'general'}}" data-index="{{index}}" data-value="{{item}}" bindtap="toggleSelectedMeaning" hidden="{{item === null}}">{{item}}</text>
      </block>
    </view>
    <!-- 输入心情 -->
    <view class="idea">
      <textarea class="input-mood" placeholder="在这里记录你此刻所想..." value="{{moodInputValue}}" bindinput="handleInput"></textarea>
    </view>
    <button class="submit-button" bindtap="handleSubmit">记录</button>
  </view>
</view>